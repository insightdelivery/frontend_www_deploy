(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[442],{3265:function(e,t,r){Promise.resolve().then(r.bind(r,5235))},5235:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var s=r(7437),n=r(2265),i=r(9376),a=r(9501),o=r(3590),l=r(7119),c=r(1323),d=r(2381),m=r(279),u=r(5060);let h=l.Ry({phone:l.Z_().min(1,"핸드폰 번호를 입력해주세요."),name:l.Z_().min(1,"이름을 입력해주세요."),position:l.Z_().min(1,"직분을 입력해주세요."),birth_year:l.Rx().min(1900).max(new Date().getFullYear()),birth_month:l.Rx().min(1).max(12),birth_day:l.Rx().min(1).max(31),region_type:l.Km(["DOMESTIC","FOREIGN"]),region_domestic:l.Z_().optional(),region_foreign:l.Z_().optional()}),x=["서울특별시","부산광역시","대구광역시","인천광역시","광주광역시","대전광역시","울산광역시","세종특별자치시","경기도","강원도","충청북도","충청남도","전라북도","전라남도","경상북도","경상남도","제주특별자치도"];function p(){let e=(0,i.useRouter)(),[t,r]=(0,n.useState)(!1),[l,p]=(0,n.useState)(!0),[f,g]=(0,n.useState)(null),[y,b]=(0,n.useState)(""),{register:v,handleSubmit:j,watch:_,formState:{errors:N}}=(0,a.cI)({resolver:(0,o.F)(h),defaultValues:{region_type:"DOMESTIC"}}),w=_("region_type");(0,n.useEffect)(()=>{(async()=>{try{let e=(0,c.bG)();if(null==e?void 0:e.email){b(e.email),p(!1);return}let t=await (0,c.jo)();b(t.email)}catch(t){console.error("사용자 정보 조회 오류:",t),e.push("/login")}finally{p(!1)}})()},[e]);let I=async t=>{r(!0),g(null);try{let r={email:y,phone:t.phone,name:t.name,position:t.position,birth_year:t.birth_year,birth_month:t.birth_month,birth_day:t.birth_day,region_type:t.region_type,..."DOMESTIC"===t.region_type?{region_domestic:t.region_domestic||"",region_foreign:""}:{region_foreign:t.region_foreign||"",region_domestic:""}};await (0,c.mS)(r),e.push("/")}catch(e){var s,n;g((null===(n=e.response)||void 0===n?void 0:null===(s=n.data)||void 0===s?void 0:s.message)||e.message||"프로필 완성에 실패했습니다.")}finally{r(!1)}};return l?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"사용자 정보를 불러오는 중..."})]})}):(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4 py-12",children:(0,s.jsxs)("div",{className:"w-full max-w-2xl space-y-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-center text-3xl font-bold tracking-tight text-gray-900",children:"기본정보 입력"}),(0,s.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"서비스 이용을 위해 추가 정보를 입력해주세요."})]}),(0,s.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:j(I),children:[f&&(0,s.jsx)("div",{className:"rounded-md bg-red-50 p-4",children:(0,s.jsx)("p",{className:"text-sm text-red-800",children:f})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{htmlFor:"email",children:"이메일"}),(0,s.jsx)(m.I,{id:"email",type:"email",value:y,disabled:!0,className:"mt-1 bg-gray-100"}),(0,s.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"이메일은 변경할 수 없습니다."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{htmlFor:"phone",children:"핸드폰"}),(0,s.jsx)(m.I,{id:"phone",type:"tel",placeholder:"010-1234-5678",...v("phone"),className:"mt-1"}),N.phone&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:N.phone.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{htmlFor:"name",children:"이름"}),(0,s.jsx)(m.I,{id:"name",type:"text",...v("name"),className:"mt-1"}),N.name&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:N.name.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{htmlFor:"position",children:"직분 (교회 직분)"}),(0,s.jsx)(m.I,{id:"position",type:"text",placeholder:"예: 목사, 전도사, 장로 등",...v("position"),className:"mt-1"}),N.position&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:N.position.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{children:"생일"}),(0,s.jsxs)("div",{className:"mt-1 grid grid-cols-3 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(m.I,{type:"number",placeholder:"년",min:"1900",max:new Date().getFullYear(),...v("birth_year",{valueAsNumber:!0})}),N.birth_year&&(0,s.jsx)("p",{className:"mt-1 text-xs text-red-600",children:N.birth_year.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.I,{type:"number",placeholder:"월",min:"1",max:"12",...v("birth_month",{valueAsNumber:!0})}),N.birth_month&&(0,s.jsx)("p",{className:"mt-1 text-xs text-red-600",children:N.birth_month.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.I,{type:"number",placeholder:"일",min:"1",max:"31",...v("birth_day",{valueAsNumber:!0})}),N.birth_day&&(0,s.jsx)("p",{className:"mt-1 text-xs text-red-600",children:N.birth_day.message})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u._,{children:"지역"}),(0,s.jsxs)("div",{className:"mt-1 space-y-2",children:[(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"radio",value:"DOMESTIC",...v("region_type"),className:"mr-2"}),(0,s.jsx)("span",{className:"text-sm",children:"내국인"})]}),(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"radio",value:"FOREIGN",...v("region_type"),className:"mr-2"}),(0,s.jsx)("span",{className:"text-sm",children:"외국인"})]})]}),"DOMESTIC"===w?(0,s.jsxs)("select",{...v("region_domestic"),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",children:[(0,s.jsx)("option",{value:"",children:"도/광역시를 선택하세요"}),x.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]}):(0,s.jsx)(m.I,{type:"text",placeholder:"국가/지역을 입력하세요",...v("region_foreign")}),N.region_domestic&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:N.region_domestic.message}),N.region_foreign&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:N.region_foreign.message})]})]})]}),(0,s.jsx)("div",{children:(0,s.jsx)(d.z,{type:"submit",className:"w-full",disabled:t,children:t?"저장 중...":"완료"})})]})]})})}},2381:function(e,t,r){"use strict";r.d(t,{z:function(){return c}});var s=r(7437),n=r(2265),i=r(5293),a=r(535),o=r(3448);let l=(0,a.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=n.forwardRef((e,t)=>{let{className:r,variant:n,size:a,asChild:c=!1,...d}=e,m=c?i.g7:"button";return(0,s.jsx)(m,{className:(0,o.cn)(l({variant:n,size:a,className:r})),ref:t,...d})});c.displayName="Button"},279:function(e,t,r){"use strict";r.d(t,{I:function(){return a}});var s=r(7437),n=r(2265),i=r(3448);let a=n.forwardRef((e,t)=>{let{className:r,type:n,...a}=e;return(0,s.jsx)("input",{type:n,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...a})});a.displayName="Input"},5060:function(e,t,r){"use strict";r.d(t,{_:function(){return c}});var s=r(7437),n=r(2265),i=r(1107),a=r(535),o=r(3448);let l=(0,a.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)(i.f,{ref:t,className:(0,o.cn)(l(),r),...n})});c.displayName=i.f.displayName},3448:function(e,t,r){"use strict";r.d(t,{cn:function(){return i}});var s=r(1994),n=r(3335);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,s.W)(t))}},1323:function(e,t,r){"use strict";r.d(t,{mS:function(){return d},jo:function(){return c},bG:function(){return x},$8:function(){return p},x4:function(){return o},kS:function(){return u},z2:function(){return l},ck:function(){return m}});var s=r(3464),n=r(4131),i=r(257);let a=s.Z.create({baseURL:i.env.NEXT_PUBLIC_API_URL||"https://api.inde.kr",headers:{"Content-Type":"application/json"},withCredentials:!0});a.interceptors.request.use(e=>{let t=n.Z.get("accessToken");return t&&e.headers&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),a.interceptors.response.use(e=>e,async e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)!==401||(n.Z.remove("accessToken"),n.Z.remove("refreshToken"),n.Z.remove("userInfo"),window.location.pathname.includes("/login")||(window.location.href="/login?error=UNAUTHORIZED")),Promise.reject(e)});let o=async e=>{try{let t=await a.post("/auth/login/",e);return t.data.access_token&&t.data.refresh_token&&h(t.data.access_token,t.data.refresh_token,t.data.user),t.data}catch(e){throw console.error("로그인 API 오류:",e),e}},l=async e=>{try{return(await a.post("/auth/register/",e)).data}catch(e){throw console.error("회원가입 API 오류:",e),e}},c=async()=>{try{return(await a.get("/me/")).data}catch(e){throw console.error("사용자 정보 조회 API 오류:",e),e}},d=async e=>{try{let t=await a.put("/profile/complete/",e);return t.data.user&&n.Z.set("userInfo",JSON.stringify(t.data.user),{expires:1,secure:!0,sameSite:"strict",path:"/"}),t.data}catch(e){throw console.error("프로필 완성 API 오류:",e),e}},m=async e=>d(e),u=async()=>{try{await a.post("/auth/logout/")}catch(e){console.error("로그아웃 API 오류:",e)}finally{n.Z.remove("accessToken"),n.Z.remove("refreshToken"),n.Z.remove("userInfo"),window.location.href="/login"}},h=(e,t,r)=>{let s={expires:1,secure:!0,sameSite:"strict",path:"/"};n.Z.set("accessToken",e,s),n.Z.set("refreshToken",t,{...s,expires:7}),r&&n.Z.set("userInfo",JSON.stringify(r),s)},x=()=>{let e=n.Z.get("userInfo");if(e)try{return JSON.parse(e)}catch(e){}return null},p=()=>!!n.Z.get("accessToken")}},function(e){e.O(0,[35,137,269,971,117,744],function(){return e(e.s=3265)}),_N_E=e.O()}]);