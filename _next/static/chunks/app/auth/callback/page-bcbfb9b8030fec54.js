(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[453],{976:function(e,r,n){Promise.resolve().then(n.bind(n,9838))},9376:function(e,r,n){"use strict";var s=n(5475);n.o(s,"usePathname")&&n.d(r,{usePathname:function(){return s.usePathname}}),n.o(s,"useRouter")&&n.d(r,{useRouter:function(){return s.useRouter}}),n.o(s,"useSearchParams")&&n.d(r,{useSearchParams:function(){return s.useSearchParams}})},9838:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return a}});var s=n(7437),o=n(2265),t=n(9376),l=n(9636);let i={OAUTH_DENIED:"Google 로그인이 취소되었습니다.",OAUTH_NO_CODE:"인증 정보를 받지 못했습니다.",OAUTH_CONFIG:"Google 로그인 설정이 되어 있지 않습니다.",OAUTH_FAILED:"Google 로그인에 실패했습니다.",OAUTH_NO_EMAIL:"이메일 정보를 받지 못했습니다.",EMAIL_ALREADY_REGISTERED:"이미 같은 이메일로 가입된 계정이 있습니다. 비밀번호 로그인을 이용해 주세요."};function u(){let e=(0,t.useRouter)(),r=(0,t.useSearchParams)(),[n,u]=(0,o.useState)("loading"),[a,c]=(0,o.useState)("");return((0,o.useEffect)(()=>{(async()=>{let n=r.get("access_token"),s=r.get("refresh_token"),o=r.get("error");if(o){c(i[o]||"소셜 로그인에 실패했습니다."),u("error"),setTimeout(()=>{e.replace("/login?error=".concat(encodeURIComponent(o)))},2500);return}if(n&&s)try{(0,l.Fm)(n,s);let o=await (0,l.jo)();(0,l.Fm)(n,s,o);let t="signup"===r.get("from");o.profile_completed?e.replace(t?"/?welcome=1":"/"):"GOOGLE"===o.joined_via?e.replace("/signup/complete-profile"):e.replace("/signup/complete");return}catch(r){console.error("OAuth 콜백 후 사용자 정보 조회 오류:",r),u("error"),c("로그인 처리 중 오류가 발생했습니다."),setTimeout(()=>e.replace("/login?error=OAUTH_FAILED"),2500);return}try{let r=await (0,l.jo)();r.profile_completed?e.replace("/"):"GOOGLE"===r.joined_via?e.replace("/signup/complete-profile"):e.replace("/signup/complete")}catch(r){console.error("콜백 처리 오류:",r),u("error"),c("로그인 처리 중 오류가 발생했습니다."),setTimeout(()=>e.replace("/login?error=OAUTH_FAILED"),2500)}})()},[e,r]),"error"===n)?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:(0,s.jsxs)("div",{className:"text-center max-w-sm",children:[(0,s.jsx)("p",{className:"text-red-600",children:a}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"로그인 페이지로 이동합니다..."})]})}):(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"로그인 처리 중..."})]})})}function a(){return(0,s.jsx)(o.Suspense,{fallback:(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}),children:(0,s.jsx)(u,{})})}},4453:function(e,r,n){"use strict";n.d(r,{l:function(){return t}});var s=n(3464),o=n(4131);n(257);let t=()=>"https://api.inde.kr",l=s.Z.create({baseURL:t(),headers:{"Content-Type":"application/json"},withCredentials:!0}),i=e=>{if(!e)return!1;let r=e.replace(t(),"").split("?")[0].replace(/^https?:\/\/[^/]+/,"")||e;return/^\/api\/(notices|faqs)(\/|$)/.test(r)};l.interceptors.request.use(e=>{if(i(e.url))return e;let r=o.Z.get("accessToken");return r&&e.headers&&(e.headers.Authorization="Bearer ".concat(r)),e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e,async e=>{var r;return(null===(r=e.response)||void 0===r?void 0:r.status)!==401||(o.Z.remove("accessToken"),o.Z.remove("refreshToken"),o.Z.remove("userInfo"),window.location.pathname.includes("/login")||(window.location.href="/login?error=UNAUTHORIZED")),Promise.reject(e)}),r.Z=l},9636:function(e,r,n){"use strict";n.d(r,{$8:function(){return h},A8:function(){return f},Fm:function(){return d},bG:function(){return v},ck:function(){return a},hP:function(){return m},jo:function(){return i},kS:function(){return c},lm:function(){return p},mS:function(){return u},x4:function(){return t},z2:function(){return l}});var s=n(4453),o=n(4131);let t=async e=>{var r,n,o,t,l,i,u,a,c,v,p,f;try{let o=(await s.Z.post("/auth/login/",e)).data,t=null!==(n=null==o?void 0:null===(r=o.IndeAPIResponse)||void 0===r?void 0:r.Result)&&void 0!==n?n:(null==o?void 0:o.access_token)&&(null==o?void 0:o.user)?o:null;if((null==t?void 0:t.access_token)&&(null==t?void 0:t.user))return d(t.access_token,t.refresh_token,t.user),t;if((null==o?void 0:o.IndeAPIResponse)&&"00"!==o.IndeAPIResponse.ErrorCode)throw Error(o.IndeAPIResponse.Message||"로그인에 실패했습니다.");throw Error("응답 형식이 올바르지 않습니다.")}catch(e){throw console.error("로그인 API 오류:",e),Error(null!==(f=null!==(p=null!==(v=null===(l=e.response)||void 0===l?void 0:null===(t=l.data)||void 0===t?void 0:null===(o=t.IndeAPIResponse)||void 0===o?void 0:o.Message)&&void 0!==v?v:null===(u=e.response)||void 0===u?void 0:null===(i=u.data)||void 0===i?void 0:i.error)&&void 0!==p?p:null===(c=e.response)||void 0===c?void 0:null===(a=c.data)||void 0===a?void 0:a.message)&&void 0!==f?f:e instanceof Error?e.message:"로그인에 실패했습니다.")}},l=async e=>{var r,n,o,t,l,i,u,a,c,v,p,f,m,h,g,I,y,R,A;try{let u=(await s.Z.post("/auth/register/",e)).data,a=null!==(t=null!==(o=u&&"IndeAPIResponse"in u&&(null===(r=u.IndeAPIResponse)||void 0===r?void 0:r.Result))&&void 0!==o?o:u&&"object"==typeof u&&"Result"in u?u.Result:null)&&void 0!==t?t:u;if((null==a?void 0:a.success)&&(null==a?void 0:a.email))return{success:!0,message:a.message||"",email:a.email,user:a.user};if((null==a?void 0:a.access_token)&&(null==a?void 0:a.user))return d(a.access_token,a.refresh_token||"",a.user),{success:!0,message:"",email:e.email,user:a.user};let c=null!==(i=null!==(l=u&&"IndeAPIResponse"in u?null===(n=u.IndeAPIResponse)||void 0===n?void 0:n.Message:null)&&void 0!==l?l:u&&"object"==typeof u&&"Message"in u?u.Message:null)&&void 0!==i?i:"응답 형식이 올바르지 않습니다.";throw Error(c)}catch(e){throw console.error("회원가입 API 오류:",e),Error(null!==(A=null!==(R=null!==(y=null!==(I=null===(c=e.response)||void 0===c?void 0:null===(a=c.data)||void 0===a?void 0:null===(u=a.IndeAPIResponse)||void 0===u?void 0:u.Message)&&void 0!==I?I:null===(p=e.response)||void 0===p?void 0:null===(v=p.data)||void 0===v?void 0:v.Message)&&void 0!==y?y:null===(m=e.response)||void 0===m?void 0:null===(f=m.data)||void 0===f?void 0:f.error)&&void 0!==R?R:null===(g=e.response)||void 0===g?void 0:null===(h=g.data)||void 0===h?void 0:h.message)&&void 0!==A?A:e instanceof Error?e.message:"회원가입에 실패했습니다.")}},i=async()=>{try{var e,r,n;let o=(await s.Z.get("/me/")).data,t=null!==(n=null!==(r=null==o?void 0:null===(e=o.IndeAPIResponse)||void 0===e?void 0:e.Result)&&void 0!==r?r:o&&"Result"in o?o.Result:null)&&void 0!==n?n:o;if(!t||"object"!=typeof t)throw Error("사용자 정보를 불러올 수 없습니다.");return t}catch(e){throw console.error("사용자 정보 조회 API 오류:",e),e}},u=async e=>{try{var r,n,t;let l=(await s.Z.put("/profile/complete/",e)).data,i=null!==(t=null!==(n=null==l?void 0:null===(r=l.IndeAPIResponse)||void 0===r?void 0:r.Result)&&void 0!==n?n:l&&"Result"in l?l.Result:null)&&void 0!==t?t:l;return(null==i?void 0:i.user)&&o.Z.set("userInfo",JSON.stringify(i.user),{expires:1,secure:!0,sameSite:"strict",path:"/"}),i}catch(e){throw console.error("프로필 완성 API 오류:",e),e}},a=async e=>u(e),c=async()=>{try{await s.Z.post("/auth/logout/")}catch(e){console.error("로그아웃 API 오류:",e)}finally{o.Z.remove("accessToken"),o.Z.remove("refreshToken"),o.Z.remove("userInfo"),window.location.href="/login"}},d=(e,r,n)=>{let s={expires:1,secure:!0,sameSite:"strict",path:"/"};o.Z.set("accessToken",e,s),o.Z.set("refreshToken",r,{...s,expires:7}),n&&o.Z.set("userInfo",JSON.stringify(n),s)},v=()=>{let e=o.Z.get("userInfo");if(e)try{return JSON.parse(e)}catch(e){}return null},p=async e=>{var r,n,o,t,l,i,u,a,c,d,v,p,f,m;try{let t=(await s.Z.post("/auth/verify-email/",{token:e})).data,l=null!==(o=null!==(n=t&&"IndeAPIResponse"in t?null===(r=t.IndeAPIResponse)||void 0===r?void 0:r.Result:null)&&void 0!==n?n:t&&"object"==typeof t&&"Result"in t?t.Result:null)&&void 0!==o?o:t;if(l&&l.success)return{success:!0,message:l.message};return{success:!1,error:(null==l?void 0:l.error)||"인증에 실패했습니다."}}catch(e){return{success:!1,error:null!==(m=null!==(f=null!==(p=null===(i=e.response)||void 0===i?void 0:null===(l=i.data)||void 0===l?void 0:null===(t=l.IndeAPIResponse)||void 0===t?void 0:t.Message)&&void 0!==p?p:null===(a=e.response)||void 0===a?void 0:null===(u=a.data)||void 0===u?void 0:u.error)&&void 0!==f?f:null===(v=e.response)||void 0===v?void 0:null===(d=v.data)||void 0===d?void 0:null===(c=d.Result)||void 0===c?void 0:c.error)&&void 0!==m?m:"인증 처리 중 오류가 발생했습니다."}}},f=async e=>{try{let r=(await s.Z.post("/auth/resend-verification-email/",{email:e})).data;if(!1!==r.success&&(r.message||r.success))return{success:!0,message:r.message};return{success:!1,error:r.error||"재발송에 실패했습니다."}}catch(e){var r,n;return{success:!1,error:(null===(n=e.response)||void 0===n?void 0:null===(r=n.data)||void 0===r?void 0:r.error)||"재발송 처리 중 오류가 발생했습니다."}}},m=()=>o.Z.get("accessToken"),h=()=>!!o.Z.get("accessToken")}},function(e){e.O(0,[825,971,117,744],function(){return e(e.s=976)}),_N_E=e.O()}]);