(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[69],{9351:function(e,s,a){Promise.resolve().then(a.bind(a,6664))},6664:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return g}});var t=a(7437),l=a(2265),n=a(9376),r=a(7648),i=a(1649),c=a(9636),d=a(9820),x=a(2381),u=a(9174),m=a(6220),h=a(3804),o=a(9140),j=a(1131);function p(e,s){var a,t,l,n,r;let i=null==e?void 0:null===(a=e.response)||void 0===a?void 0:a.status;return 401===i||403===i?(null==e?void 0:null===(n=e.response)||void 0===n?void 0:null===(l=n.data)||void 0===l?void 0:null===(t=l.Message)||void 0===t?void 0:t.trim())||"로그인이 필요하거나 권한이 없습니다. 다시 로그인해 주세요.":null!==(r=null==e?void 0:e.message)&&void 0!==r?r:s}function f(){let e=(0,n.useRouter)(),s=(0,n.useSearchParams)().get("id"),a=s?Number(s):null,[f,g]=(0,l.useState)([]),[y,N]=(0,l.useState)(!0),[v,w]=(0,l.useState)(null),[b,S]=(0,l.useState)(1),[C,_]=(0,l.useState)(0),[k,O]=(0,l.useState)(0),[z,q]=(0,l.useState)(null),[Z,D]=(0,l.useState)(!1),[E,M]=(0,l.useState)(null),[A,R]=(0,l.useState)(""),[F,K]=(0,l.useState)(!1),[L,P]=(0,l.useState)(null),Y=(0,c.bG)(),G=!!(null==Y?void 0:Y.is_staff);(0,l.useEffect)(()=>{if(!(0,c.hP)()){e.replace("/login?next=/inquiry");return}let s=!1;return N(!0),w(null),(0,i.Kx)({page:b,page_size:20}).then(e=>{s||(g(Array.isArray(e.results)?e.results:[]),_("number"==typeof e.count?e.count:0),O(Math.ceil(("number"==typeof e.count?e.count:0)/20)||1))}).catch(a=>{if(!s){var t;(null==a?void 0:null===(t=a.response)||void 0===t?void 0:t.status)===401?e.replace("/login?next=/inquiry"):w(p(a,"목록을 불러오지 못했습니다."))}}).finally(()=>{s||N(!1)}),()=>{s=!0}},[b,e]),(0,l.useEffect)(()=>{if(!a||Number.isNaN(a)){q(null),M(null);return}let s=!1;return D(!0),M(null),(0,i.p8)(a).then(e=>{if(!s){var a;q(e),R(null!==(a=e.answer)&&void 0!==a?a:"")}}).catch(a=>{if(!s){var t;(null==a?void 0:null===(t=a.response)||void 0===t?void 0:t.status)===401?e.replace("/login?next=/inquiry"):M(p(a,"문의를 불러오지 못했습니다."))}}).finally(()=>{s||D(!1)}),()=>{s=!0}},[a,e]);let H=async()=>{if(a&&A.trim()){P(null),K(!0);try{let e=await (0,i.U$)(a,A.trim());q(e)}catch(a){var s;(null===(s=a.response)||void 0===s?void 0:s.status)===401?e.replace("/login"):P(p(a,"답변 저장에 실패했습니다."))}finally{K(!1)}}};return a&&!Number.isNaN(a)?E?(0,t.jsxs)("main",{className:"min-h-screen bg-white",children:[(0,t.jsxs)("div",{className:"mx-auto max-w-[1220px] px-4 py-12",children:[(0,t.jsx)("div",{className:"rounded-md bg-red-50 p-4 text-red-800",children:E}),(0,t.jsx)(x.z,{variant:"outline",className:"mt-4",asChild:!0,children:(0,t.jsx)(r.default,{href:"/inquiry",children:"목록으로"})})]}),(0,t.jsx)(j.Z,{})]}):(0,t.jsxs)("main",{className:"min-h-screen bg-white",children:[(0,t.jsxs)("div",{className:"mx-auto max-w-[1220px] px-4 sm:px-6 py-8 sm:py-12",children:[(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)(r.default,{href:"/inquiry",className:"text-sm text-gray-500 hover:text-gray-900",children:"← 문의 목록"})}),Z?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(o.O,{className:"h-8 w-3/4"}),(0,t.jsx)(o.O,{className:"h-4 w-24"}),(0,t.jsx)(o.O,{className:"h-32 w-full"})]}):z?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(d.Zb,{children:[(0,t.jsxs)(d.Ol,{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:z.title}),(0,t.jsx)(u.C,{variant:"answered"===z.status?"answered":"waiting",children:"answered"===z.status?"답변완료":"접수"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:function(e){try{return new Date(e).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(s){return e}}(z.created_at)})]}),(0,t.jsxs)(d.aY,{className:"space-y-4",children:[(0,t.jsx)("div",{className:"rounded-md bg-gray-50 p-4 text-gray-700 whitespace-pre-wrap",children:z.content}),z.answer&&(0,t.jsxs)("div",{className:"rounded-md bg-green-50 p-4",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-green-800 mb-1",children:"관리자 답변"}),(0,t.jsx)("div",{className:"text-gray-700 whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:z.answer}})]})]})]}),G&&(0,t.jsxs)(d.Zb,{className:"mt-6",children:[(0,t.jsx)(d.Ol,{className:"pb-2",children:(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"관리자 답변 작성"})}),(0,t.jsxs)(d.aY,{className:"space-y-4",children:[L&&(0,t.jsx)("div",{className:"rounded-md bg-red-50 p-3 text-sm text-red-800",children:L}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m._,{htmlFor:"answer",children:"답변 내용"}),(0,t.jsx)("textarea",{id:"answer",value:A,onChange:e=>R(e.target.value),rows:6,placeholder:"답변을 입력하세요.",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-gray-900 focus:outline-none focus:ring-1 focus:ring-gray-900"})]}),(0,t.jsx)(x.z,{onClick:H,disabled:F,children:F?"저장 중…":"답변 저장"})]})]})]}):null]}),(0,t.jsx)(j.Z,{})]}):(0,t.jsxs)("main",{className:"min-h-screen bg-white",children:[(0,t.jsxs)("div",{className:"mx-auto max-w-[1220px] px-4 sm:px-6 py-8 sm:py-12",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl sm:text-3xl font-black text-gray-900",children:"1:1 문의"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"문의 내역을 확인하세요."})]}),(0,t.jsx)(x.z,{asChild:!0,children:(0,t.jsx)(r.default,{href:"/inquiry/write",children:"문의하기"})})]}),(0,t.jsxs)(d.Zb,{className:"mt-6",children:[(0,t.jsx)(d.Ol,{className:"pb-2",children:(0,t.jsx)(d.ll,{className:"text-lg",children:"내 문의"})}),(0,t.jsxs)(d.aY,{children:[v&&(0,t.jsx)("div",{className:"rounded-md bg-red-50 p-4 text-sm text-red-800",children:v}),y?(0,t.jsx)("div",{className:"space-y-3",children:Array.from({length:5}).map((e,s)=>(0,t.jsx)(o.O,{className:"h-12 w-full"},s))}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(h.iA,{children:[(0,t.jsx)(h.xD,{children:(0,t.jsxs)(h.SC,{children:[(0,t.jsx)(h.ss,{children:"제목"}),(0,t.jsx)(h.ss,{className:"w-[100px]",children:"상태"}),(0,t.jsx)(h.ss,{className:"w-[100px]",children:"날짜"})]})}),(0,t.jsx)(h.RM,{children:0===(null!=f?f:[]).length?(0,t.jsx)(h.SC,{children:(0,t.jsx)(h.pj,{colSpan:3,className:"text-center text-gray-500 py-8",children:"문의 내역이 없습니다."})}):(null!=f?f:[]).map(e=>(0,t.jsxs)(h.SC,{children:[(0,t.jsx)(h.pj,{children:(0,t.jsx)(r.default,{href:"/inquiry?id=".concat(e.id),className:"font-medium text-gray-900 hover:underline",children:e.title})}),(0,t.jsx)(h.pj,{children:(0,t.jsx)(u.C,{variant:"answered"===e.status?"answered":"waiting",children:"answered"===e.status?"답변완료":"접수"})}),(0,t.jsx)(h.pj,{className:"text-gray-500 text-sm",children:function(e){try{return new Date(e).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"})}catch(s){return e}}(e.created_at)})]},e.id))})]}),k>1&&(0,t.jsxs)("div",{className:"mt-4 flex items-center justify-center gap-2",children:[(0,t.jsx)(x.z,{variant:"outline",size:"sm",disabled:b<=1,onClick:()=>S(e=>Math.max(1,e-1)),children:"이전"}),(0,t.jsxs)("span",{className:"text-sm text-gray-600",children:[b," / ",k]}),(0,t.jsx)(x.z,{variant:"outline",size:"sm",disabled:b>=k,onClick:()=>S(e=>e+1),children:"다음"})]})]})]})]})]}),(0,t.jsx)(j.Z,{})]})}function g(){return(0,t.jsx)(l.Suspense,{fallback:(0,t.jsx)("main",{className:"min-h-screen bg-white flex items-center justify-center",children:(0,t.jsx)("p",{className:"text-gray-500",children:"로딩 중…"})}),children:(0,t.jsx)(f,{})})}}},function(e){e.O(0,[972,825,137,261,648,971,117,744],function(){return e(e.s=9351)}),_N_E=e.O()}]);