(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{3425:function(e,n,s){Promise.resolve().then(s.bind(s,1380))},1380:function(e,n,s){"use strict";s.r(n),s.d(n,{default:function(){return h}});var r=s(7437),t=s(2265),i=s(9376),o=s(9501),l=s(3590),a=s(7119),d=s(9636),c=s(2381),u=s(279),m=s(5060);let v=a.Ry({phone:a.Z_().min(1,"핸드폰 번호를 입력해주세요."),name:a.Z_().min(1,"이름을 입력해주세요."),nickname:a.Z_().min(1,"닉네임을 입력해주세요."),position:a.Z_().min(1,"직분을 입력해주세요."),birth_year:a.Rx().min(1900).max(new Date().getFullYear()),birth_month:a.Rx().min(1).max(12),birth_day:a.Rx().min(1).max(31),region_type:a.Km(["DOMESTIC","FOREIGN"]),region_domestic:a.Z_().optional(),region_foreign:a.Z_().optional()}),p=["서울특별시","부산광역시","대구광역시","인천광역시","광주광역시","대전광역시","울산광역시","세종특별자치시","경기도","강원도","충청북도","충청남도","전라북도","전라남도","경상북도","경상남도","제주특별자치도"];function h(){let e=(0,i.useRouter)(),[n,s]=(0,t.useState)(!1),[a,h]=(0,t.useState)(!0),[f,x]=(0,t.useState)(null),[g,y]=(0,t.useState)(""),[b,j]=(0,t.useState)(""),{register:_,handleSubmit:N,watch:I,reset:w,formState:{errors:R}}=(0,o.cI)({resolver:(0,l.F)(v)}),k=I("region_type");(0,t.useEffect)(()=>{if(!(0,d.$8)()){e.push("/login");return}(async()=>{try{let e=await (0,d.jo)();y(e.email),j(e.joined_via||"LOCAL"),w({phone:e.phone||"",name:e.name||"",nickname:e.nickname||"",position:e.position||"",birth_year:e.birth_year||new Date().getFullYear()-30,birth_month:e.birth_month||1,birth_day:e.birth_day||1,region_type:e.region_type||"DOMESTIC",region_domestic:e.region_domestic||"",region_foreign:e.region_foreign||""})}catch(n){console.error("사용자 정보 조회 오류:",n),e.push("/login")}finally{h(!1)}})()},[e,w]);let A=async e=>{s(!0),x(null);try{let n={email:g,phone:e.phone,name:e.name,nickname:e.nickname,position:e.position,birth_year:e.birth_year,birth_month:e.birth_month,birth_day:e.birth_day,region_type:e.region_type,..."DOMESTIC"===e.region_type?{region_domestic:e.region_domestic||"",region_foreign:""}:{region_foreign:e.region_foreign||"",region_domestic:""}};await (0,d.ck)(n),alert("프로필이 성공적으로 수정되었습니다."),window.location.reload()}catch(e){var n,r;x((null===(r=e.response)||void 0===r?void 0:null===(n=r.data)||void 0===n?void 0:n.message)||e.message||"프로필 수정에 실패했습니다.")}finally{s(!1)}},Z=async()=>{confirm("로그아웃 하시겠습니까?")&&await (0,d.kS)()};return a?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"사용자 정보를 불러오는 중..."})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 px-4 py-12",children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto space-y-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"내 정보"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"회원 정보를 조회하고 수정할 수 있습니다."})]}),(0,r.jsxs)("form",{className:"bg-white rounded-lg shadow p-6 space-y-6",onSubmit:N(A),children:[f&&(0,r.jsx)("div",{className:"rounded-md bg-red-50 p-4",children:(0,r.jsx)("p",{className:"text-sm text-red-800",children:f})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(m._,{htmlFor:"email",children:"이메일"}),(0,r.jsx)(u.I,{id:"email",type:"email",value:g,disabled:!0,className:"mt-1 bg-gray-100"}),(0,r.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"이메일은 변경할 수 없습니다."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m._,{htmlFor:"joined_via",children:"가입 방법"}),(0,r.jsx)(u.I,{id:"joined_via",type:"text",value:{LOCAL:"일반 가입",KAKAO:"카카오",NAVER:"네이버",GOOGLE:"구글"}[b]||"일반 가입",disabled:!0,className:"mt-1 bg-gray-100"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m._,{htmlFor:"phone",children:"핸드폰"}),(0,r.jsx)(u.I,{id:"phone",type:"tel",placeholder:"010-1234-5678",..._("phone"),className:"mt-1"}),R.phone&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:R.phone.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m._,{htmlFor:"name",children:"이름"}),(0,r.jsx)(u.I,{id:"name",type:"text",..._("name"),className:"mt-1"}),R.name&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:R.name.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m._,{htmlFor:"nickname",children:"닉네임"}),(0,r.jsx)(u.I,{id:"nickname",type:"text",..._("nickname"),className:"mt-1"}),R.nickname&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:R.nickname.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m._,{htmlFor:"position",children:"직분 (교회 직분)"}),(0,r.jsx)(u.I,{id:"position",type:"text",placeholder:"예: 목사, 전도사, 장로 등",..._("position"),className:"mt-1"}),R.position&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:R.position.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m._,{children:"생일"}),(0,r.jsxs)("div",{className:"mt-1 grid grid-cols-3 gap-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(u.I,{type:"number",placeholder:"년",min:"1900",max:new Date().getFullYear(),..._("birth_year",{valueAsNumber:!0})}),R.birth_year&&(0,r.jsx)("p",{className:"mt-1 text-xs text-red-600",children:R.birth_year.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(u.I,{type:"number",placeholder:"월",min:"1",max:"12",..._("birth_month",{valueAsNumber:!0})}),R.birth_month&&(0,r.jsx)("p",{className:"mt-1 text-xs text-red-600",children:R.birth_month.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(u.I,{type:"number",placeholder:"일",min:"1",max:"31",..._("birth_day",{valueAsNumber:!0})}),R.birth_day&&(0,r.jsx)("p",{className:"mt-1 text-xs text-red-600",children:R.birth_day.message})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(m._,{children:"지역"}),(0,r.jsxs)("div",{className:"mt-1 space-y-2",children:[(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"radio",value:"DOMESTIC",..._("region_type"),className:"mr-2"}),(0,r.jsx)("span",{className:"text-sm",children:"내국인"})]}),(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"radio",value:"FOREIGN",..._("region_type"),className:"mr-2"}),(0,r.jsx)("span",{className:"text-sm",children:"외국인"})]})]}),"DOMESTIC"===k?(0,r.jsxs)("select",{..._("region_domestic"),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",children:[(0,r.jsx)("option",{value:"",children:"도/광역시를 선택하세요"}),p.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]}):(0,r.jsx)(u.I,{type:"text",placeholder:"국가/지역을 입력하세요",..._("region_foreign")}),R.region_domestic&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:R.region_domestic.message}),R.region_foreign&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:R.region_foreign.message})]})]})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(c.z,{type:"submit",className:"flex-1",disabled:n,children:n?"저장 중...":"정보 수정"}),(0,r.jsx)(c.z,{type:"button",variant:"outline",onClick:Z,className:"flex-1",children:"로그아웃"})]})]})]})})}},2381:function(e,n,s){"use strict";s.d(n,{z:function(){return d}});var r=s(7437),t=s(2265),i=s(5293),o=s(535),l=s(3448);let a=(0,o.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=t.forwardRef((e,n)=>{let{className:s,variant:t,size:o,asChild:d=!1,...c}=e,u=d?i.g7:"button";return(0,r.jsx)(u,{className:(0,l.cn)(a({variant:t,size:o,className:s})),ref:n,...c})});d.displayName="Button"},279:function(e,n,s){"use strict";s.d(n,{I:function(){return o}});var r=s(7437),t=s(2265),i=s(3448);let o=t.forwardRef((e,n)=>{let{className:s,type:t,...o}=e;return(0,r.jsx)("input",{type:t,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:n,...o})});o.displayName="Input"},5060:function(e,n,s){"use strict";s.d(n,{_:function(){return d}});var r=s(7437),t=s(2265),i=s(1107),o=s(535),l=s(3448);let a=(0,o.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=t.forwardRef((e,n)=>{let{className:s,...t}=e;return(0,r.jsx)(i.f,{ref:n,className:(0,l.cn)(a(),s),...t})});d.displayName=i.f.displayName},4453:function(e,n,s){"use strict";s.d(n,{l:function(){return i}});var r=s(3464),t=s(4131);s(257);let i=()=>"https://api.inde.kr",o=r.Z.create({baseURL:i(),headers:{"Content-Type":"application/json"},withCredentials:!0});o.interceptors.request.use(e=>{let n=t.Z.get("accessToken");return n&&e.headers&&(e.headers.Authorization="Bearer ".concat(n)),e},e=>Promise.reject(e)),o.interceptors.response.use(e=>e,async e=>{var n;return(null===(n=e.response)||void 0===n?void 0:n.status)!==401||(t.Z.remove("accessToken"),t.Z.remove("refreshToken"),t.Z.remove("userInfo"),window.location.pathname.includes("/login")||(window.location.href="/login?error=UNAUTHORIZED")),Promise.reject(e)}),n.Z=o},3448:function(e,n,s){"use strict";s.d(n,{cn:function(){return i}});var r=s(1994),t=s(3335);function i(){for(var e=arguments.length,n=Array(e),s=0;s<e;s++)n[s]=arguments[s];return(0,t.m6)((0,r.W)(n))}},9636:function(e,n,s){"use strict";s.d(n,{$8:function(){return f},A8:function(){return p},Fm:function(){return u},bG:function(){return m},ck:function(){return d},hP:function(){return h},jo:function(){return l},kS:function(){return c},lm:function(){return v},mS:function(){return a},x4:function(){return i},z2:function(){return o}});var r=s(4453),t=s(4131);let i=async e=>{var n,s,t,i,o,l,a,d,c,m,v,p;try{let t=(await r.Z.post("/auth/login/",e)).data,i=null!==(s=null==t?void 0:null===(n=t.IndeAPIResponse)||void 0===n?void 0:n.Result)&&void 0!==s?s:(null==t?void 0:t.access_token)&&(null==t?void 0:t.user)?t:null;if((null==i?void 0:i.access_token)&&(null==i?void 0:i.user))return u(i.access_token,i.refresh_token,i.user),i;if((null==t?void 0:t.IndeAPIResponse)&&"00"!==t.IndeAPIResponse.ErrorCode)throw Error(t.IndeAPIResponse.Message||"로그인에 실패했습니다.");throw Error("응답 형식이 올바르지 않습니다.")}catch(e){throw console.error("로그인 API 오류:",e),Error(null!==(p=null!==(v=null!==(m=null===(o=e.response)||void 0===o?void 0:null===(i=o.data)||void 0===i?void 0:null===(t=i.IndeAPIResponse)||void 0===t?void 0:t.Message)&&void 0!==m?m:null===(a=e.response)||void 0===a?void 0:null===(l=a.data)||void 0===l?void 0:l.error)&&void 0!==v?v:null===(c=e.response)||void 0===c?void 0:null===(d=c.data)||void 0===d?void 0:d.message)&&void 0!==p?p:e instanceof Error?e.message:"로그인에 실패했습니다.")}},o=async e=>{var n,s,t,i,o,l,a,d,c,m,v,p,h,f,x,g,y,b,j;try{let a=(await r.Z.post("/auth/register/",e)).data,d=null!==(i=null!==(t=a&&"IndeAPIResponse"in a&&(null===(n=a.IndeAPIResponse)||void 0===n?void 0:n.Result))&&void 0!==t?t:a&&"object"==typeof a&&"Result"in a?a.Result:null)&&void 0!==i?i:a;if((null==d?void 0:d.success)&&(null==d?void 0:d.email))return{success:!0,message:d.message||"",email:d.email,user:d.user};if((null==d?void 0:d.access_token)&&(null==d?void 0:d.user))return u(d.access_token,d.refresh_token||"",d.user),{success:!0,message:"",email:e.email,user:d.user};let c=null!==(l=null!==(o=a&&"IndeAPIResponse"in a?null===(s=a.IndeAPIResponse)||void 0===s?void 0:s.Message:null)&&void 0!==o?o:a&&"object"==typeof a&&"Message"in a?a.Message:null)&&void 0!==l?l:"응답 형식이 올바르지 않습니다.";throw Error(c)}catch(e){throw console.error("회원가입 API 오류:",e),Error(null!==(j=null!==(b=null!==(y=null!==(g=null===(c=e.response)||void 0===c?void 0:null===(d=c.data)||void 0===d?void 0:null===(a=d.IndeAPIResponse)||void 0===a?void 0:a.Message)&&void 0!==g?g:null===(v=e.response)||void 0===v?void 0:null===(m=v.data)||void 0===m?void 0:m.Message)&&void 0!==y?y:null===(h=e.response)||void 0===h?void 0:null===(p=h.data)||void 0===p?void 0:p.error)&&void 0!==b?b:null===(x=e.response)||void 0===x?void 0:null===(f=x.data)||void 0===f?void 0:f.message)&&void 0!==j?j:e instanceof Error?e.message:"회원가입에 실패했습니다.")}},l=async()=>{try{var e,n,s;let t=(await r.Z.get("/me/")).data,i=null!==(s=null!==(n=null==t?void 0:null===(e=t.IndeAPIResponse)||void 0===e?void 0:e.Result)&&void 0!==n?n:t&&"Result"in t?t.Result:null)&&void 0!==s?s:t;if(!i||"object"!=typeof i)throw Error("사용자 정보를 불러올 수 없습니다.");return i}catch(e){throw console.error("사용자 정보 조회 API 오류:",e),e}},a=async e=>{try{var n,s,i;let o=(await r.Z.put("/profile/complete/",e)).data,l=null!==(i=null!==(s=null==o?void 0:null===(n=o.IndeAPIResponse)||void 0===n?void 0:n.Result)&&void 0!==s?s:o&&"Result"in o?o.Result:null)&&void 0!==i?i:o;return(null==l?void 0:l.user)&&t.Z.set("userInfo",JSON.stringify(l.user),{expires:1,secure:!0,sameSite:"strict",path:"/"}),l}catch(e){throw console.error("프로필 완성 API 오류:",e),e}},d=async e=>a(e),c=async()=>{try{await r.Z.post("/auth/logout/")}catch(e){console.error("로그아웃 API 오류:",e)}finally{t.Z.remove("accessToken"),t.Z.remove("refreshToken"),t.Z.remove("userInfo"),window.location.href="/login"}},u=(e,n,s)=>{let r={expires:1,secure:!0,sameSite:"strict",path:"/"};t.Z.set("accessToken",e,r),t.Z.set("refreshToken",n,{...r,expires:7}),s&&t.Z.set("userInfo",JSON.stringify(s),r)},m=()=>{let e=t.Z.get("userInfo");if(e)try{return JSON.parse(e)}catch(e){}return null},v=async e=>{var n,s,t,i,o,l,a,d,c,u,m,v,p,h;try{let i=(await r.Z.post("/auth/verify-email/",{token:e})).data,o=null!==(t=null!==(s=i&&"IndeAPIResponse"in i?null===(n=i.IndeAPIResponse)||void 0===n?void 0:n.Result:null)&&void 0!==s?s:i&&"object"==typeof i&&"Result"in i?i.Result:null)&&void 0!==t?t:i;if(o&&o.success)return{success:!0,message:o.message};return{success:!1,error:(null==o?void 0:o.error)||"인증에 실패했습니다."}}catch(e){return{success:!1,error:null!==(h=null!==(p=null!==(v=null===(l=e.response)||void 0===l?void 0:null===(o=l.data)||void 0===o?void 0:null===(i=o.IndeAPIResponse)||void 0===i?void 0:i.Message)&&void 0!==v?v:null===(d=e.response)||void 0===d?void 0:null===(a=d.data)||void 0===a?void 0:a.error)&&void 0!==p?p:null===(m=e.response)||void 0===m?void 0:null===(u=m.data)||void 0===u?void 0:null===(c=u.Result)||void 0===c?void 0:c.error)&&void 0!==h?h:"인증 처리 중 오류가 발생했습니다."}}},p=async e=>{try{let n=(await r.Z.post("/auth/resend-verification-email/",{email:e})).data;if(!1!==n.success&&(n.message||n.success))return{success:!0,message:n.message};return{success:!1,error:n.error||"재발송에 실패했습니다."}}catch(e){var n,s;return{success:!1,error:(null===(s=e.response)||void 0===s?void 0:null===(n=s.data)||void 0===n?void 0:n.error)||"재발송 처리 중 오류가 발생했습니다."}}},h=()=>t.Z.get("accessToken"),f=()=>!!t.Z.get("accessToken")},1107:function(e,n,s){"use strict";s.d(n,{f:function(){return a}});var r=s(2265);s(4887);var t=s(5293),i=s(7437),o=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,n)=>{let s=(0,t.Z8)(`Primitive.${n}`),o=r.forwardRef((e,r)=>{let{asChild:t,...o}=e,l=t?s:n;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,i.jsx)(l,{...o,ref:r})});return o.displayName=`Primitive.${n}`,{...e,[n]:o}},{}),l=r.forwardRef((e,n)=>(0,i.jsx)(o.label,{...e,ref:n,onMouseDown:n=>{var s;n.target.closest("button, input, select, textarea")||(null===(s=e.onMouseDown)||void 0===s||s.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));l.displayName="Label";var a=l}},function(e){e.O(0,[825,137,944,971,117,744],function(){return e(e.s=3425)}),_N_E=e.O()}]);